//.............................................................................
//
// Ninja log engine declarations
//

namespace log {

//.............................................................................

enumf PacketCodeFlags
{
	Foldable          = 0x80000000,
	MergeableBackward = 0x40000000,
	MergeableForward  = 0x20000000,
	Mergeable         = 0x60000000,
}

//. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

enumf LineAttrFlags
{
	TileIcon,
	Delimiter,
	Override,
}

//. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

struct LineAttr: gui.TextAttr
{
	LineAttrFlags m_flags;
	uint_t m_iconIdx;
}

//.............................................................................

enum PartKind
{
	PlainText = 0,
	HyperText,
	Bin,
}

//. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

class RepresenterTarget
{
	constd uint_t m_packetCode;
	constd uint64_t m_timestamp;

	LineAttr m_lineAttr;

	abstract void addPart (
		PartKind partKind,
		uint_t partCode,
		const void* p,
		size_t size
		);

	void addHyperText (
		uint_t partCode,
		const char* text
		)
	{
		addPart (PartKind.HyperText, partCode, text, strlen (text));
	}

	void addHyperText (const char* text)
	{
		addPart (PartKind.HyperText, m_packetCode, text, strlen (text));
	}

	void addBin (
		uint_t partCode,
		const void* p,
		size_t size
		)
	{
		addPart (PartKind.Bin, partCode, p, size);
	}

	void addBin (
		const void* p,
		size_t size
		)
	{
		addPart (PartKind.Bin, m_packetCode, p, size);
	}
}

//.............................................................................

class Representer
{
	abstract bool represent (
		RepresenterTarget* target,
		uint_t packetCode,
		const void* p,
		size_t size,
		uint64_t foldFlags
		);
}

//.............................................................................

} // namespace log {
